---
title: "Informe Técnico – Proyecto Spotify"
author: "Santiago Arboleda"
date: "`r Sys.Date()`"
output: pdf_document
---

<!-- Para compilar a PDF necesitas LaTeX instalado (recomendado: TinyTeX).
Instalación rápida desde R:
install.packages('tinytex'); tinytex::install_tinytex()
-->

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

# Paquetes necesarios
pkgs <- c("dplyr", "ggplot2", "knitr", "readr")
to_install <- pkgs[!pkgs %in% installed.packages()[, "Package"]]
if (length(to_install)) install.packages(to_install, dependencies = TRUE)
lapply(pkgs, library, character.only = TRUE)
```

## Cargar datos

```{r cargar-datos}
# Lee el archivo CSV ubicado en la misma carpeta que este .Rmd
# Si está en otra ruta, actualiza el path, por ejemplo: "data/Spotify2024_clean.csv"
spotify <- readr::read_csv("Spotify2024_clean.csv", show_col_types = FALSE)

# Verificación de columnas requeridas
req_cols <- c(
  "cancion","album","artista","fecha_lanz","isrc","ranking_hist","puntaje",
  "spotify_streams","spotify_playlists","spotify_alcance","spotify_pop",
  "youtube_views","youtube_likes","tiktok_posts","tiktok_likes","tiktok_views",
  "youtube_alcance","apple_playlists","airplay_spins","sirius_spins",
  "deezer_playlists","deezer_alcance","amazon_playlists","pandora_streams",
  "pandora_stations","soundcloud_streams","shazam","tidal_pop","explicito"
)

faltan <- setdiff(req_cols, names(spotify))
stopifnot("Faltan columnas requeridas en 'Spotify2024_clean.csv'." = length(faltan) == 0)
```

## Resumen del Proyecto y Objetivos

Este **informe técnico breve** resume los hallazgos principales del dataset **Spotify 2024** en relación con los objetivos de:  
1) **Cuantificar** el consumo y popularidad de canciones,  
2) **Explorar** la relación entre plataformas (Spotify y YouTube), y  
3) **Sintetizar** indicadores clave para orientar decisiones.

---

## Tabla de Indicadores (Resumen)

```{r tabla-indicadores}
resumen <- spotify %>%
  summarise(
    Total_Canciones           = dplyr::n_distinct(cancion),
    Total_Artistas            = dplyr::n_distinct(artista),
    Promedio_Streams_Spotify  = mean(spotify_streams, na.rm = TRUE),
    Max_Streams_Spotify       = max(spotify_streams, na.rm = TRUE),
    Popularidad_Spotify_media = mean(spotify_pop, na.rm = TRUE),
    Vistas_YT_media           = mean(youtube_views, na.rm = TRUE),
    Vistas_TikTok_media       = mean(tiktok_views, na.rm = TRUE)
  )

knitr::kable(resumen, caption = "Tabla 1. Indicadores resumidos – Spotify 2024")
```

El dataset contiene **`r resumen$Total_Canciones`** canciones de **`r resumen$Total_Artistas`** artistas.  
En promedio, se registran **`r format(round(resumen$Promedio_Streams_Spotify,0), big.mark=',')` streams en Spotify**,  
con un **máximo** de **`r format(resumen$Max_Streams_Spotify, big.mark=',')`**.  
La **popularidad media** en Spotify es **`r round(resumen$Popularidad_Spotify_media,1)`** puntos.

---

## Gráfico de Resultados (Principal)

```{r grafico-principal, fig.width=7, fig.height=5}
ggplot(spotify, aes(x = spotify_streams, y = youtube_views)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Relación entre Streams en Spotify y Vistas en YouTube",
       x = "Streams en Spotify",
       y = "Vistas en YouTube") +
  theme_minimal()
```

La correlación entre **streams en Spotify** y **vistas en YouTube** es **`r {co <- suppressWarnings(cor(spotify$spotify_streams, spotify$youtube_views, use='complete.obs')); ifelse(is.finite(co), round(co,3), 'NA')}`**.  
Este resultado **`r if (!is.na(co) && is.finite(co) && co>0) 'apoya' else 'no apoya'`** la expectativa de una asociación positiva entre plataformas.

---

## Explicación e Interpretación (con resultados de R)

Para cuantificar la relación anterior, se ajusta un **modelo lineal simple**:

```{r modelo-lineal, echo=TRUE}
modelo <- lm(youtube_views ~ spotify_streams, data = spotify)
summary(modelo)
```

El coeficiente sugiere que, por cada unidad adicional de **streams en Spotify**, las **vistas en YouTube** cambian en  
**`r signif(coef(modelo)['spotify_streams'], 4)`** unidades (aprox.).  
El **R²** del modelo es **`r signif(summary(modelo)$r.squared, 4)`**, lo que indica el grado de variación explicada.

---

## Conclusiones

- Los **indicadores clave** sintetizan el nivel de consumo y popularidad (Tabla 1).  
- El **gráfico principal** y el **modelo lineal** evidencian la relación entre plataformas, útil para promoción y análisis de rendimiento.  
- Los resultados están alineados con los **objetivos del proyecto**, proporcionando una base para decisiones informadas.
